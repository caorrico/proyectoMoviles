<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Municipio Digital - Atención Virtual</title>
  <link rel="stylesheet" href="styles.css" />
  <link rel="stylesheet" href="chat-widget.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="container">
      <div class="header-content">
        <div class="logo">
          <i class="fas fa-city"></i>
          <span>Municipio Digital</span>
        </div>
        <nav class="nav">
          <a href="#servicios">Servicios</a>
          <a href="#tramites">Trámites</a>
          <a href="#noticias">Noticias</a>
          <a href="#contacto">Contacto</a>
        </nav>
      </div>
    </div>
  </header>

  <!-- Hero Section -->
  <section class="hero">
    <div class="container">
      <div class="hero-content">
        <h1>Bienvenido al Portal Ciudadano</h1>
        <p>Accede a todos los servicios municipales de forma rápida y sencilla. Nuestro asistente virtual está disponible 24/7 para ayudarte.</p>
        <div class="hero-buttons">
          <button class="btn-primary" onclick="toggleChat()">
            <i class="fas fa-comments"></i>
            Consultar Asistente Virtual
          </button>
          <button class="btn-secondary">
            <i class="fas fa-file-alt"></i>
            Ver Trámites
          </button>
        </div>
      </div>
    </div>
  </section>

  <!-- Servicios Rápidos -->
  <section class="servicios-rapidos">
    <div class="container">
      <h2>Servicios Más Consultados</h2>
      <div class="servicios-grid">
        <div class="servicio-card">
          <i class="fas fa-hammer"></i>
          <h3>Permisos de Construcción</h3>
          <p>Solicita permisos para obra nueva, ampliación o refacción</p>
        </div>
        <div class="servicio-card">
          <i class="fas fa-trash"></i>
          <h3>Recolección de Residuos</h3>
          <p>Consulta horarios y días de recolección por zona</p>
        </div>
        <div class="servicio-card">
          <i class="fas fa-file-invoice-dollar"></i>
          <h3>Impuestos y Tasas</h3>
          <p>Pago de impuestos municipales y consulta de deudas</p>
        </div>
        <div class="servicio-card">
          <i class="fas fa-calendar-alt"></i>
          <h3>Turnos Online</h3>
          <p>Reserva tu turno para atención presencial</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Noticias -->
  <section class="noticias">
    <div class="container">
      <h2>Últimas Noticias</h2>
      <div class="noticias-grid">
        <article class="noticia-card">
          <div class="noticia-imagen">
            <i class="fas fa-bullhorn"></i>
          </div>
          <div class="noticia-content">
            <h3>Nuevo Sistema de Gestión Digital</h3>
            <p>Implementamos un asistente conversacional para mejorar la atención ciudadana...</p>
            <span class="fecha">5 de Agosto, 2025</span>
          </div>
        </article>
        <article class="noticia-card">
          <div class="noticia-imagen">
            <i class="fas fa-road"></i>
          </div>
          <div class="noticia-content">
            <h3>Obras de Mejoramiento Vial</h3>
            <p>Iniciamos trabajos de bacheo y señalización en principales avenidas...</p>
            <span class="fecha">3 de Agosto, 2025</span>
          </div>
        </article>
      </div>
    </div>
  </section>

  <!-- Chat Widget Launcher -->
  <div class="chat-launcher" id="chatLauncher" role="button" aria-label="Abrir asistente virtual">
    <div class="chat-icon-container">
      <i class="fas fa-robot chat-icon"></i>
      <div class="chat-pulse"></div>
    </div>
    <span class="chat-tooltip">¡Pregúntame lo que necesites!</span>
  </div>

  <!-- Chat Window -->
  <div class="chat-window" id="chatWindow">
    <div class="chat-header">
      <div class="chat-header-info">
        <div class="assistant-avatar">
          <i class="fas fa-robot"></i>
        </div>
        <div class="assistant-info">
          <h4>Asistente Municipal</h4>
          <span class="status">En línea</span>
        </div>
      </div>
      <div class="chat-controls">
        <button class="chat-minimize" onclick="minimizeChat()">
          <i class="fas fa-minus"></i>
        </button>
        <button class="chat-close" onclick="closeChat()">
          <i class="fas fa-times"></i>
        </button>
      </div>
    </div>
    
    <div class="chat-messages" id="chatMessages">
      <div class="message bot-message">
        <div class="message-avatar">
          <i class="fas fa-robot"></i>
        </div>
        <div class="message-content">
          <p>¡Hola! Soy tu asistente virtual del municipio. Puedo ayudarte con:</p>
          <ul>
            <li>Información sobre trámites y documentación</li>
            <li>Horarios de recolección de residuos</li>
            <li>Consultas sobre impuestos y tasas</li>
            <li>Procedimientos municipales</li>
          </ul>
          <p>¿En qué puedo ayudarte hoy?</p>
        </div>
        <span class="message-time">Ahora</span>
      </div>
    </div>

    <div class="chat-quick-questions">
      <div class="quick-question" onclick="sendQuickQuestion('¿Qué documentos necesito para el permiso de construcción?')">
        Permisos de construcción
      </div>
      <div class="quick-question" onclick="sendQuickQuestion('¿Cuándo pasa el recolector por mi barrio?')">
        Recolección de residuos
      </div>
      <div class="quick-question" onclick="sendQuickQuestion('¿Cómo pago mis impuestos?')">
        Pago de impuestos
      </div>
    </div>

    <div class="chat-input-container">
      <div class="chat-input-wrapper">
        <input type="text" class="chat-input" id="chatInput" placeholder="Escribe tu consulta aquí...">
        <button class="send-button" onclick="sendMessage()">
          <i class="fas fa-paper-plane"></i>
        </button>
      </div>
      <div class="chat-typing-indicator" id="typingIndicator" style="display: none;">
        <div class="typing-dots">
          <span></span>
          <span></span>
          <span></span>
        </div>
        <span>El asistente está escribiendo...</span>
      </div>
    </div>
  </div>

  <!-- Chat Overlay -->
  <div class="chat-overlay" id="chatOverlay" onclick="closeChat()"></div>

  <script>
    let chatOpen = false;
    let messageCount = 1;

    function toggleChat() {
      chatOpen = !chatOpen;
      const chatWindow = document.getElementById('chatWindow');
      const chatOverlay = document.getElementById('chatOverlay');
      const chatLauncher = document.getElementById('chatLauncher');
      
      if (chatOpen) {
        chatWindow.classList.add('active');
        chatOverlay.classList.add('active');
        chatLauncher.style.display = 'none';
        document.getElementById('chatInput').focus();
      } else {
        chatWindow.classList.remove('active');
        chatOverlay.classList.remove('active');
        chatLauncher.style.display = 'flex';
      }
    }

    function closeChat() {
      chatOpen = false;
      document.getElementById('chatWindow').classList.remove('active');
      document.getElementById('chatOverlay').classList.remove('active');
      document.getElementById('chatLauncher').style.display = 'flex';
    }

    function minimizeChat() {
      document.getElementById('chatWindow').classList.toggle('minimized');
    }

    function sendMessage() {
      const input = document.getElementById('chatInput');
      const message = input.value.trim();
      
      if (message) {
        addMessage(message, 'user');
        input.value = '';
        
        // Simular respuesta del bot
        setTimeout(() => {
          showTypingIndicator();
          setTimeout(() => {
            hideTypingIndicator();
            addBotResponse(message);
          }, 2000);
        }, 500);
      }
    }

    function sendQuickQuestion(question) {
      addMessage(question, 'user');
      setTimeout(() => {
        showTypingIndicator();
        setTimeout(() => {
          hideTypingIndicator();
          addBotResponse(question);
        }, 2000);
      }, 500);
    }

    function addMessage(text, sender) {
      const messagesContainer = document.getElementById('chatMessages');
      const messageDiv = document.createElement('div');
      messageDiv.className = `message ${sender}-message`;
      
      const time = new Date().toLocaleTimeString('es-ES', { 
        hour: '2-digit', 
        minute: '2-digit' 
      });

      if (sender === 'user') {
        messageDiv.innerHTML = `
          <div class="message-content">
            <p>${text}</p>
          </div>
          <span class="message-time">${time}</span>
        `;
      } else {
        messageDiv.innerHTML = `
          <div class="message-avatar">
            <i class="fas fa-robot"></i>
          </div>
          <div class="message-content">
            <p>${text}</p>
          </div>
          <span class="message-time">${time}</span>
        `;
      }
      
      messagesContainer.appendChild(messageDiv);
      messagesContainer.scrollTop = messagesContainer.scrollHeight;
    }

    function addBotResponse(userMessage) {
      let response = "Gracias por tu consulta. Te he transferido con un especialista que te contactará pronto.";
      
      if (userMessage.toLowerCase().includes('construcción') || userMessage.toLowerCase().includes('permiso')) {
        response = "Para obtener un permiso de construcción necesitas: 1) Planos aprobados por un arquitecto, 2) Certificado de zonificación, 3) Formulario de solicitud completado, 4) Comprobante de pago de tasas. El trámite demora aproximadamente 15 días hábiles. ¿Necesitas más información específica?";
      } else if (userMessage.toLowerCase().includes('recolector') || userMessage.toLowerCase().includes('basura') || userMessage.toLowerCase().includes('residuos')) {
        response = "El cronograma de recolección varía por zona. Por favor, indícame tu barrio o dirección para darte información específica. Generalmente: Zona Norte (Lunes y Jueves), Zona Sur (Martes y Viernes), Zona Centro (Miércoles y Sábado). Los horarios son de 6:00 AM a 12:00 PM.";
      } else if (userMessage.toLowerCase().includes('impuesto') || userMessage.toLowerCase().includes('pago') || userMessage.toLowerCase().includes('tasa')) {
        response = "Puedes pagar tus impuestos de las siguientes formas: 1) Online a través de nuestro portal web, 2) En bancos adheridos, 3) En oficinas municipales. Para consultar deudas pendientes, necesito tu número de contribuyente. ¿Tienes alguna consulta específica sobre pagos?";
      }
      
      addMessage(response, 'bot');
    }

    function showTypingIndicator() {
      document.getElementById('typingIndicator').style.display = 'flex';
      const messagesContainer = document.getElementById('chatMessages');
      messagesContainer.scrollTop = messagesContainer.scrollHeight;
    }

    function hideTypingIndicator() {
      document.getElementById('typingIndicator').style.display = 'none';
    }

    // Event listeners
    document.getElementById('chatLauncher').addEventListener('click', toggleChat);
    
    document.getElementById('chatInput').addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        sendMessage();
      }
    });

    // Animación de pulso
    setInterval(() => {
      const pulse = document.querySelector('.chat-pulse');
      if (pulse && !chatOpen) {
        pulse.style.animation = 'none';
        setTimeout(() => {
          pulse.style.animation = 'pulse 2s infinite';
        }, 100);
      }
    }, 5000);
  </script>
</body>
</html>
